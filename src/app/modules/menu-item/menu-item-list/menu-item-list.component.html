<div class="menu-items-container">
  <div class="search-bar">
    <span class="p-input-icon-left">
      <i class="pi pi-search"></i>
      <input type="text" 
             pInputText 
             placeholder="Cerca prodotto per nome o descrizione..." 
             [(ngModel)]="searchText"
             (input)="onSearch()">
    </span>
    <div class="items-count">
      <i class="pi pi-shopping-bag"></i>
      <span>{{filteredItems.length}} prodotti</span>
    </div>
  </div>

  <div class="items-grid" *ngIf="filteredItems.length > 0">
    <div *ngFor="let item of filteredItems; let i = index" 
         class="item-card"
         [class.editing]="isEditing(item)">
      
      <div class="card-header">
        <div class="item-number" [style.background-color]="categoryColor">
          #{{item.externalId || 'â€”'}}
        </div>
        <div class="card-actions" *ngIf="!isEditing(item)">
          <button pButton pRipple 
                  icon="pi pi-pencil"
                  class="p-button-rounded p-button-text p-button-sm"
                  pTooltip="Modifica"
                  tooltipPosition="top"
                  (click)="onRowEditInit(item)">
          </button>
          <button pButton pRipple 
                  icon="pi pi-trash"
                  class="p-button-rounded p-button-text p-button-danger p-button-sm"
                  pTooltip="Elimina"
                  tooltipPosition="top"
                  (click)="onDelete(item)">
          </button>
        </div>
        <div class="card-actions" *ngIf="isEditing(item)">
          <button pButton pRipple 
                  icon="pi pi-check"
                  class="p-button-rounded p-button-text p-button-success p-button-sm"
                  pTooltip="Salva"
                  tooltipPosition="top"
                  (click)="onRowEditSave(item)">
          </button>
          <button pButton pRipple 
                  icon="pi pi-times"
                  class="p-button-rounded p-button-text p-button-danger p-button-sm"
                  pTooltip="Annulla"
                  tooltipPosition="top"
                  (click)="onRowEditCancel(item, i)">
          </button>
        </div>
      </div>

      <div class="card-content">
        <div class="item-name">
          <ng-container *ngIf="!isEditing(item)">
            <i class="pi pi-tag"></i>
            <span>{{item.name}}</span>
          </ng-container>
          <input *ngIf="isEditing(item)" 
                 pInputText 
                 type="text" 
                 [(ngModel)]="item.name"
                 placeholder="Nome prodotto">
        </div>

        <div class="item-description">
          <ng-container *ngIf="!isEditing(item)">
            <i class="pi pi-align-left"></i>
            <span>{{item.description || 'Nessuna descrizione'}}</span>
          </ng-container>
          <textarea *ngIf="isEditing(item)" 
                    pInputTextarea 
                    [(ngModel)]="item.description"
                    placeholder="Descrizione prodotto"
                    rows="2">
          </textarea>
        </div>

        <div class="item-external-id" *ngIf="isEditing(item)">
          <label>ID Esterno (GSG)</label>
          <input pInputText 
                 type="number" 
                 [(ngModel)]="item.externalId"
                 placeholder="ID esterno">
        </div>
      </div>
    </div>
  </div>

  <div class="empty-state" *ngIf="filteredItems.length === 0 && (!items || items.length === 0)">
    <i class="pi pi-inbox"></i>
    <h4>Nessun prodotto in {{categoryName}}</h4>
    <p>Inizia aggiungendo il primo prodotto a questa categoria</p>
  </div>

  <div class="empty-state" *ngIf="filteredItems.length === 0 && items && items.length > 0">
    <i class="pi pi-search"></i>
    <h4>Nessun risultato</h4>
    <p>Nessun prodotto corrisponde alla ricerca "{{searchText}}"</p>
  </div>
</div>
