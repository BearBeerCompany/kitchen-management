<p-toast></p-toast>
<h3>{{i18n.SETTINGS.TITLE}}</h3>
<main>
  <div style="display: flex; justify-content: flex-start;">
    <button pButton pRipple label="Inizializzazione GSG"
      icon="pi pi-plus"
      class="p-button-info"
      (click)="onGSGInit()">
    </button>
  </div>
  
  <h3>Impostazioni Visualizzazione</h3>
  <div class="settings-section">
    <div class="setting-row">
      <div class="setting-info">
        <label for="showNotify">Notifiche</label>
        <small>Attiva le notifiche per i nuovi ordini</small>
      </div>
      <p-inputSwitch inputId="showNotify" [(ngModel)]="showNotify" (onChange)="onShowNotifyChange()"></p-inputSwitch>
    </div>
    <div class="setting-row">
      <div class="setting-info">
        <label for="showItemDelays">Mostra Ritardi Singoli</label>
        <small>Visualizza i badge di ritardo sugli elementi nella dashboard delle piastre</small>
      </div>
      <p-inputSwitch inputId="showItemDelays" [(ngModel)]="showItemDelays" (onChange)="onShowItemDelaysChange()"></p-inputSwitch>
    </div>
  </div>

  <h3>Soglie Ritardi</h3>
  <div class="settings-section">
    <div class="setting-row">
      <div class="setting-info">
        <label for="warningThreshold">Soglia Avviso (Giallo)</label>
        <small>Tempo in minuti prima che un ordine diventi giallo</small>
      </div>
      <p-inputNumber 
        inputId="warningThreshold"
        [(ngModel)]="delayThresholds.warning"
        [min]="1"
        [max]="60"
        [showButtons]="true"
        suffix=" min"
        (onBlur)="onDelayThresholdChange()">
      </p-inputNumber>
    </div>
    <div class="setting-row">
      <div class="setting-info">
        <label for="dangerThreshold">Soglia Pericolo (Rosso)</label>
        <small>Tempo in minuti prima che un ordine diventi rosso</small>
      </div>
      <p-inputNumber 
        inputId="dangerThreshold"
        [(ngModel)]="delayThresholds.danger"
        [min]="2"
        [max]="120"
        [showButtons]="true"
        suffix=" min"
        (onBlur)="onDelayThresholdChange()">
      </p-inputNumber>
    </div>
    <div class="setting-row" style="justify-content: flex-end;">
      <button pButton 
        label="Ripristina Predefiniti" 
        icon="pi pi-refresh"
        class="p-button-secondary p-button-sm"
        (click)="resetDelayThresholds()">
      </button>
    </div>
  </div>
  
  <h3>Modifica Piastre</h3>
  <section id="plate-settings__container">
    <ng-container *ngFor="let plate of plates">
      <plate-info [config]="plate"
                  (delete)="onDelete($event)"
                  (edit)="showDialog($event)"
                  (switch)="onSwitchPlate($event)"
      ></plate-info>
    </ng-container>
  </section>
</main>
<p-dialog header="Modifica Piastra"
          [style]="{height: '80vh'}"
          [(visible)]="display"
          [draggable]="false">
  <form (ngSubmit)="onSubmit()" [formGroup]="form!">
    <h3>{{i18n.PLATE.FORM.TITLE}}</h3>
    <label>{{i18n.PLATE.FORM.NAME}}</label>
    <input formControlName="name"
           pInputText
           type="text">
    <label>{{i18n.PLATE.FORM.COLOR}}</label>
    <p-colorPicker [inline]="true"
                   formControlName="color"></p-colorPicker>
    <label>{{i18n.PLATE.FORM.NUMBER}}</label>
    <p-inputNumber [max]="200"
                   [min]="0"
                   [showButtons]="true"
                   formControlName="number"></p-inputNumber>
    <div id="confirmForm">
      <button (click)="discardForm()"
              [label]="i18n.COMMON.UNDO"
              class="p-button-secondary" pButton pRipple
              type="button"></button>
      <button [disabled]="form?.valid ? !form?.valid : true"
              [label]="i18n.COMMON.SAVE"
              class="p-button-success" pButton pRipple
              type="submit"></button>
    </div>
  </form>
</p-dialog>
<p-confirmDialog header="Conferma"
                 icon="pi pi-exclamation-triangle"
                 acceptLabel="Si"
                 rejectLabel="No">
</p-confirmDialog>
